{# ===== SUKOON COLLECTIONS PAGE ===== #}

{% set collections = context.collections | default(widget.data.collections) %}
{% set title = widget.data.title | default(t('pages.collections.title')) | default('Collections') %}

{# {{ collections | json }} #}

<section id="{{ widget.id }}" class="bg-section-a py-16 max-lg:py-12 max-sm:py-8 min-h-[60vh]">
  <div class="container mx-auto px-12 max-lg:px-6 max-sm:px-4">

    {# ——— Page Header ——— #}
    <div class="mb-14 max-sm:mb-8 reveal">
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4">
        <div>
          <h1 class="text-3xl max-sm:text-2xl font-bold text-gray-900 mb-2">{{ title }}</h1>
          {% if collections and collections | length > 0 %}
            <p class="text-sm text-gray-400">
              {{ collections | length }} {{ t('pages.collections.count') | default('collections') }}
            </p>
          {% endif %}
        </div>
      </div>
      <div class="w-full h-px bg-gray-100 mt-6"></div>
    </div>

    {# ——— Collections Grid ——— #}
    {% if collections and (collections | length) > 0 %}

      {# Featured — first collection large #}
      {% set featured = collections[0] %}
      <a href="/collections/{{ featured.slug }}" class="group block mb-8 reveal">
        <div class="relative overflow-hidden rounded-3xl max-sm:rounded-2xl aspect-[21/9] max-sm:aspect-[16/9] bg-gray-100">
          {% if featured.image and featured.image.fileUrl %}
            <img
              src="{{ featured.image.fileUrl }}"
              alt="{{ featured.title }}"
              class="w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-[1.03] img-fade"
              loading="lazy"
              onload="this.classList.add('is-loaded')"
            />
          {% else %}
            <div class="w-full h-full flex items-center justify-center">
              <svg class="w-16 h-16 text-gray-200" fill="none" stroke="currentColor" stroke-width="1" viewBox="0 0 24 24">
                <path d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          {% endif %}

          {# Overlay #}
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/15 to-transparent transition-opacity duration-300 group-hover:from-black/70"></div>

          {# Content #}
          <div class="absolute bottom-0 start-0 end-0 p-8 max-sm:p-5">
            <div class="flex items-end justify-between gap-4">
              <div>
                {% if featured.productCount %}
                  <span class="inline-block px-3 py-1 rounded-full bg-white/15 backdrop-blur-sm text-[11px] font-medium text-white/90 mb-3">
                    {{ featured.productCount }} {{ t('blocks.categories.products_count') | default('products') }}
                  </span>
                {% endif %}
                <h2 class="text-2xl max-sm:text-lg font-bold text-white leading-snug">
                  {{ featured.title }}
                </h2>
                {% if featured.description %}
                  <p class="text-sm text-white/80 mt-2 max-w-lg line-clamp-2 max-sm:hidden">
                    {{ featured.description | safe }}
                  </p>
                {% endif %}
              </div>
              <div class="shrink-0 w-10 h-10 max-sm:w-8 max-sm:h-8 rounded-full bg-white/15 backdrop-blur-sm flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 translate-y-2 group-hover:translate-y-0">
                <svg class="w-4 h-4 max-sm:w-3.5 max-sm:h-3.5 text-white rtl:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </a>

      {# Rest of collections — grid #}
      {% if collections | length > 1 %}
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5 max-sm:gap-3">
          {% for collection in collections %}
            {% if loop.index0 > 0 %}
              <a href="/collections/{{ collection.slug }}" class="group block reveal">
                <div class="relative overflow-hidden rounded-2xl aspect-[3/4] bg-gray-100">
                  {% if collection.image and collection.image.fileUrl %}
                    <img
                      src="{{ collection.image.fileUrl }}"
                      alt="{{ collection.title }}"
                      class="w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-105 img-fade"
                      loading="lazy"
                      onload="this.classList.add('is-loaded')"
                    />
                  {% else %}
                    <div class="w-full h-full flex items-center justify-center">
                      <svg class="w-10 h-10 text-gray-200" fill="none" stroke="currentColor" stroke-width="1" viewBox="0 0 24 24">
                        <path d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </div>
                  {% endif %}

                  {# Overlay #}
                  <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent transition-opacity duration-300 group-hover:from-black/70"></div>

                  {# Content #}
                  <div class="absolute bottom-0 start-0 end-0 p-4 max-sm:p-3">
                    <h3 class="text-[15px] max-sm:text-[13px] font-semibold text-white leading-snug line-clamp-2">
                      {{ collection.title }}
                    </h3>
                    {% if collection.productCount %}
                      <span class="text-[12px] text-white/70 mt-1 block">
                        {{ collection.productCount }} {{ t('blocks.categories.products_count') | default('products') }}
                      </span>
                    {% endif %}
                  </div>

                  {# Arrow #}
                  <div class="absolute top-3 end-3 w-8 h-8 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 translate-y-1 group-hover:translate-y-0">
                    <svg class="w-3.5 h-3.5 text-white rtl:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                  </div>
                </div>
              </a>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}

    {% else %}
      {# ——— Empty State ——— #}
      <div class="text-center py-24 reveal">
        <div class="w-20 h-20 mx-auto mb-5 rounded-full bg-gray-50 flex items-center justify-center">
          <svg class="w-9 h-9 text-gray-200" fill="none" stroke="currentColor" stroke-width="1" viewBox="0 0 24 24">
            <path d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <p class="text-gray-800 text-base font-semibold mb-2">{{ t('blocks.categories.no_categories') | default('No collections yet') }}</p>
        <p class="text-gray-400 text-sm mb-8 max-w-xs mx-auto">{{ t('blocks.categories.no_categories_desc') | default('Collections will appear here once added.') }}</p>
        <a href="/"
           class="inline-flex items-center gap-2 px-6 py-3 rounded-full text-sm font-semibold bg-gray-900 text-white hover:bg-gray-800 transition-colors">
          {{ t('cart.continue_shopping') | default('Continue shopping') }}
          <svg class="w-4 h-4 rtl:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
          </svg>
        </a>
      </div>
    {% endif %}

  </div>
</section>
